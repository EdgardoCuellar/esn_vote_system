<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}ESN ULB Brussels - Vote{% endblock %}</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet" />
  <link rel="shortcut icon" type="image/png" href="https://i.ibb.co/KhxD0v7/favicon.png">

  {% load custom_filter %}

  <style>
    /* fonts */
    .font-title { font-family: 'Lexend', sans-serif; }
    .font-body  { font-family: 'Plus Jakarta Sans', sans-serif; }
    h1,h2,h3,h4,h5,h6 { font-family: 'Lexend', sans-serif; }
    p,a,span,label,input,button { font-family: 'Plus Jakarta Sans', sans-serif; }
    body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-font-smoothing:antialiased; }

    /* palette & background gradient */
    :root {
      --pink-r: 236, 0, 140;
      --cyan-r: 0, 174, 239;
      --green-r: 122, 193, 67;
      --orange-r: 244, 123, 32;
      --blue-r: 46, 49, 146;

      --bg-top: #f0f6fb;
      --bg-bottom: #f6fbff;
      --lens-blur: 14px;
      --lens-opacity: 0.75;
    }

    body {
      background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 100%);
      min-height: 100vh;
      margin: 0;
    }

    /* container for blobs */
    .bg-blobs {
      position: fixed;
      inset: 0;
      z-index: -30;
      pointer-events: none;
      overflow: visible;
    }

    /* blob styles */
    .blob {
      position: absolute;
      border-radius: 50%;
      filter: blur(var(--lens-blur));
      opacity: var(--lens-opacity);
      mix-blend-mode: screen;
      transform: translate3d(0, 0, 0);
      will-change: transform, opacity;
      pointer-events: none;
      background-repeat: no-repeat;
      transition: opacity 0.3s linear;
    }

    /* glass utilities */
    .glass-card {
      background: rgba(255,255,255,0.56);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.45);
      box-shadow: 0 10px 40px rgba(20, 24, 40, 0.08);
      border-radius: 18px;
    }
    .glass-pill {
      background: rgba(255,255,255,0.62);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.45);
      padding: .45rem .7rem;
      border-radius: 999px;
      box-shadow: 0 6px 20px rgba(20, 24, 40, 0.05);
    }
    .glass-input {
      background: rgba(255,255,255,0.28);
      border: 1px solid rgba(255,255,255,0.35);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
    }
    .glass-btn {
      background-image: linear-gradient(90deg,
        rgba(var(--pink-r),0.92),
        rgba(var(--cyan-r),0.95));
      color: white;
      font-weight: 600;
      box-shadow: 0 8px 18px rgba(46,49,146,0.12);
    }
    .focus-ring:focus {
      outline: none;
      box-shadow: 0 0 0 4px rgba(0,174,239,0.12);
      border-color: rgba(0,174,239,0.6);
    }

    .page-content { position: relative; z-index: 10; }
    .app-container {
      padding-left: 1.25rem; padding-right: 1.25rem;
    }
    @media (min-width: 768px) { .app-container { padding-left: 4rem; padding-right: 4rem; } }

    /* Add a gradient background animation */
    .animated-gradient {
      position: fixed;
      inset: 0;
      z-index: -40;
      background: linear-gradient(120deg, #FAFAFA, #685f93ff);
      background-size: 300% 300%;
      animation: gradientMove 30s ease infinite;
    }

    @keyframes gradientMove {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Add the animated gradient background -->
  <div class="animated-gradient" aria-hidden="true"></div>
  <div class="bg-blobs" aria-hidden="true"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>

  <div class="app-container page-content pt-6 text-lg">
    <div class="w-full flex flex-col md:flex-row items-center relative">
      <div class="w-40 mx-auto flex items-center justify-center md:mb-0">
        <img src="https://i.ibb.co/QngJjCb/LOGO-NOIR-COULEUR.png" alt="ESN ULB Brussels" class="object-contain w-40 h-auto">
      </div>
            {% if request.session.token or request.session.admin_token %}
      <div class="md:absolute sm:relative flex items-center mb-3 mt-2 md:mb-0 justify-start">
        <a href="{% url 'logout' %}" class="glass-pill text-red-700 text-base font-semibold">Logout</a>
      </div>
      {% endif %}
    </div>
  </div>

  <main class="w-full min-h-[75vh] page-content app-container">
    {% block content %}{% endblock %}
  </main>

  <script>
    (function () {
      const blobConfig = {
        count: 12, // Number of blobs
        colors: ['--pink-r', '--cyan-r', '--green-r', '--orange-r', '--blue-r'], // Available colors
        minSize: 25, // Minimum size (vmin)
        maxSize: 80, // Maximum size (vmin)
        blur: '14px', // Blur amount
        opacity: 0.75, // Opacity
      };

      const container = document.querySelector('.bg-blobs');

      // Generate blobs dynamically
      for (let i = 0; i < blobConfig.count; i++) {
        const blob = document.createElement('div');
        blob.classList.add('blob');
        blob.style.background = `rgb(var(${blobConfig.colors[Math.floor(Math.random() * blobConfig.colors.length)]}))`;
        blob.style.width = blob.style.height = `${Math.random() * (blobConfig.maxSize - blobConfig.minSize) + blobConfig.minSize}vmin`;
        blob.style.left = `${Math.random() * 100}%`;
        blob.style.top = `${Math.random() * 100}%`;
        blob.style.filter = `blur(${blobConfig.blur})`;
        blob.style.opacity = blobConfig.opacity;
        container.appendChild(blob);
      }

      // Smooth motion script (same as before)
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        return; // no animation
      }

      const blobs = Array.from(document.querySelectorAll('.blob'));

      if (!blobs.length) return;

      const targetFPS = 30;
      const frameInterval = 1000 / targetFPS;
      let lastFrame = performance.now();

      const state = blobs.map((el) => {
        const rect = el.getBoundingClientRect();
        const w = rect.width || Math.max(window.innerWidth * 0.6, 300);
        const h = rect.height || w;
        const baseSpeed = 0.018;
        const f1 = baseSpeed * (0.6 + Math.random() * 0.8);
        const f2 = baseSpeed * (0.9 + Math.random() * 1.2);
        const f3 = baseSpeed * (0.035 + Math.random() * 0.055);
        const ampX = Math.min(window.innerWidth * 0.6, w * (0.25 + Math.random() * 0.7));
        const ampY = Math.min(window.innerHeight * 0.6, h * (0.18 + Math.random() * 0.6));
        const p1 = Math.random() * Math.PI * 2;
        const p2 = Math.random() * Math.PI * 2;
        const p3 = Math.random() * Math.PI * 2;
        const rotAmp = 6 + Math.random() * 8;
        return { el, ampX, ampY, f1, f2, f3, p1, p2, p3, rotAmp };
      });

      let running = true;
      document.addEventListener('visibilitychange', () => {
        running = !document.hidden;
        if (running) lastFrame = performance.now();
      }, { passive: true });

      function animate(now) {
        if (!running) {
          requestAnimationFrame(animate);
          return;
        }
        const dt = now - lastFrame;
        if (dt < frameInterval) {
          requestAnimationFrame(animate);
          return;
        }
        lastFrame = now;
        const t = now * 0.001;

        for (let i = 0; i < state.length; i++) {
          const s = state[i];
          const x = Math.sin(2 * Math.PI * s.f1 * t + s.p1) * s.ampX
                  + Math.sin(2 * Math.PI * s.f2 * t + s.p2) * (s.ampX * 0.45)
                  + Math.sin(2 * Math.PI * s.f3 * t + s.p3) * (s.ampX * 0.25);

          const y = Math.cos(2 * Math.PI * s.f2 * t + s.p2) * s.ampY
                  + Math.cos(2 * Math.PI * s.f1 * t + s.p1) * (s.ampY * 0.5)
                  + Math.sin(2 * Math.PI * s.f3 * t + s.p3) * (s.ampY * 0.28);

          const rot = Math.sin(2 * Math.PI * (s.f1 * 0.5) * t + s.p1) * s.rotAmp;

          s.el.style.transform = `translate3d(${x.toFixed(2)}px, ${y.toFixed(2)}px, 0) rotate(${rot.toFixed(2)}deg)`;
        }

        requestAnimationFrame(animate);
      }

      requestAnimationFrame(animate);
    })();
  </script>

</body>
</html>
