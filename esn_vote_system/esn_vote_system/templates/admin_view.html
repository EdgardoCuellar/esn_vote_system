{% extends 'base.html' %}

{% block content %}
{% load custom_filter %}

<div class="flex flex-col items-center px-6 lg:px-8">
  <div class="max-w-md w-full glass-card p-6 md:p-8">
    <h1 class="text-2xl font-title font-bold mb-6 text-slate-800">ESN ULB Brussels - Admin</h1>

    <div class="flex flex-col sm:flex-row gap-4 mb-6">
      <a href="{% url 'generate_token' %}" class="w-full text-center glass-btn rounded-2xl py-2 px-4" style="background-image:linear-gradient(90deg, rgba(0,174,239,0.95), rgba(0,200,255,0.92));">Generate a key</a>
      <a href="{% url 'create_vote' %}" class="w-full text-center glass-btn rounded-2xl py-2 px-4" style="background-image:linear-gradient(90deg, rgba(244,150,50,0.95), rgba(244,170,70,0.92));">Create a vote</a>
    </div>

    <hr class="border-slate-600/40 mb-6">

    <h2 class="text-lg font-semibold mb-4 text-slate-700">Votes for the session: {{ session }}</h2>

    <div class="flex flex-col space-y-3">
      {% for vote in votes %}
      <div class="w-full flex flex-row rounded-lg overflow-hidden">
        {% if vote.vote_opened %}
          {% if vote.id|is_number_of_votes_gre_than_number_of_participants %}
            <a href="{% url 'vote_results' vote.id %}" class="flex-1 flex justify-between items-center py-2 px-4 glass-card hover:bg-white/30 transition">
          {% else %}
            <a href="#" class="flex-1 flex justify-between items-center py-2 px-4 glass-card text-red-400">
          {% endif %}
        {% else %}
          <a href="{% url 'vote_update' vote.id %}" class="flex-1 flex justify-between items-center py-2 px-4 rounded-l-lg bg-slate-100 hover:bg-white/30 transition">
        {% endif %}
            <span>{{ vote.title }}</span>
            <div class="flex flex-row gap-4 text-sm">
              {% if vote.vote_opened %}
              <span><b>Votes: {{ vote.id|get_number_of_votes }}</b></span>
              {% endif %}
              <span>{% if vote.vote_opened %}Results{% else %}Edit{% endif %}</span>
            </div>
          </a>
          {% if not vote.vote_opened %}
          <a href="{% url 'publish_vote' vote.id %}" class="glass-btn rounded-none rounded-r-lg px-4 py-2 text-sm" style="background-image:linear-gradient(90deg, rgba(122,193,67,0.95), rgba(140,210,80,0.92));">Publish</a>
          {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
